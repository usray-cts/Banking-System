I'm sorry but without the specific source code, explanation and test scenarios, I cannot provide you with the unit test code. Please provide the necessary details.